<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>

    <title>OutEast - OvenPlayer</title>
    <link rel="stylesheet" href="./docs/lib/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans" rel="stylesheet">
    <!-- <link href="./docs/lib/new-age.min.css" rel="stylesheet"> -->
	<link rel="icon" type="image/png" href="favicon.png" />

   <!--  <script src="./docs/lib/vue.min.js"></script>

    <script src="./docs/lib/clipboard.min.js"></script>
    <script src="./docs/lib/popper.min.js"></script> 
    <script src="./docs/lib/bootstrap.min.js"></script> -->
	<script src="./docs/lib/hls.min.js"></script>
    <script src="https://cdn.dashjs.org/latest/dash.all.min.js"></script>
    <script src="./docs/lib/jquery-1.12.4.min.js"></script>
    <script src="./dist/ovenplayer.js"></script>
    <style>
		html, 
		body {
			height: 100%;
		}
		
		body {
			background: url(bg.jpg) no-repeat center center fixed,#3a3552;
            background: url(bg.jpg) no-repeat center center fixed,-webkit-gradient(linear,right top,left top,from(#3a3552),to(#221d39));
            background: url(bg.jpg) no-repeat center center fixed,linear-gradient(to left,#3a3552,#221d39);
			-webkit-background-size: cover;
		    -moz-background-size: cover;
		    -o-background-size: cover;
		    background-size: cover;
		}
        
		header.masthead {
            position: relative;
            width: 100%;
            padding-top: 50px;
            padding-bottom: 50px;
            color: #fff;
        }
        .btn:hover{
            border : 1px solid  #50e3c2;
            background: #50e3c2;
        }
    </style>
</head>
<body>
   
    <header class="masthead">
        <div class="container h-100">
            
                <div class="col my-auto">
                    <div id="player"></div>
                </div>
				<!-- <div id="source">Качество: <span id="slabel">none</span></div> -->
        </div>
    </header>


    <script>
		var player = "";
        const defaultSources = [
		/*		{
                type: 'webrtc',
                file:  'wss://stream.outeast.ru:3333/app/stream_encode?policy=eyJ1cmxfZXhwaXJlIjo4ODA3MDgzMDk4OTI3fQ&signature=YLqLHlUNRr6dThh5764gW3xMcPw',
                label: 'Норм качество'
            },
			{
                type: 'webrtc',
                file: 'wss://stream.outeast.ru:3333/app/stream_encode2?policy=eyJ1cmxfZXhwaXJlIjo4ODA3MDgzMDk4OTI3fQ&signature=5438pusdnkAE6tsLT0f8uaxeyok',
                label: 'Бич качество'
            }, */
			/* {
                type: 'webrtc',
                file: 'wss://stream.outeast.ru:3333/app/stream_encode2?transport=tcp&policy=eyJ1cmxfZXhwaXJlIjo4ODA3MDgzMDk4OTI3fQ&signature=8OhcDNVIksAicGDqW9Ag4MLh1Xs',
                label: '[Live] Бич качество'
            }, */
			{
                type: 'webrtc',
                file: 'wss://stream.outeast.ru:3333/app/stream_encode/webrtc_abr?transport=tcp&policy=eyJ1cmxfZXhwaXJlIjo4ODA3MDgzMDk4OTI3fQ&signature=mG_qF4qk6M_zgR5AdvgASwFRens',
                label: 'Мин. задержка'
            },
			/*{
               type: 'dash',
               file: 'https://stream.outeast.ru:8080/app/stream_encode3/manifest_ll.mpd?policy=eyJ1cmxfZXhwaXJlIjo4ODA3MDgzMDk4OTI3fQ&signature=gGX6hxgGPLTXWsWZHjeVQnAdwlY',
               label: '(Задержка) Норм качество'
            },*/
			/*{
               type: 'dash',
               file: 'https://stream.outeast.ru:8080/app/stream_encode3/manifest.mpd?policy=eyJ1cmxfZXhwaXJlIjo4ODA3MDgzMDk4OTI3fQ&signature=Drlku543wOciP0RhsTgL5Xzm2qI',
               label: 'УльтраЗадержка'
            }, */
			/*
			{
               type: 'hls',
               file: 'https://stream.outeast.ru:8080/app/stream_encode/playlist.m3u8?policy=eyJ1cmxfZXhwaXJlIjo4ODA3MDgzMDk4OTI3fQ&signature=fNPShIugWfm32J1z2YPygKzZ1Zs',
               label: '(Delay) Норм качество'
            },	*/	
			{
               type: 'hls',
               file: 'https://stream.outeast.ru:8080/app/stream_encode/hls_abr.m3u8?policy=eyJ1cmxfZXhwaXJlIjo4ODA3MDgzMDk4OTI3fQ&signature=5qi8cklaFr7wGIY66H2OsE4jw8U',
               label: 'С задержкой'
            }			
            ];
			
	//		{
    //           type: 'dash',
    //           file: 'https://stream.outeast.ru:8080/app/stream/manifest_ll.mpd?policy=eyJ1cmxfZXhwaXJlIjo4ODA3MDgzMDk4OTI3fQ&signature=Xqt1ULCfUj0P8rfZfDko8vnOh0M',
    //           label: '(Задержка) Оригинал'
    //        }	
	
			
        $( document ).ready(function() {

          player = OvenPlayer.create("player", {
                image : "standby.jpg",
                title : "OutEast TV",
                sources: defaultSources,
				autoStart: true,
				autoFallback: false,
				loadingRetryCount: 5,
				hlsConfig: {
					"liveSyncDuration": 1
				}
            });

            player.on("ready", function(data){
				player.play();
            });
			
            player.on("error", function(error){
                console.log(error);
            });

			player.on('sourceChanged', function () {
//			  if (errorRetryer) {
//				clearTimeout(errorRetryer);
//				errorRetryer = null;
//				}
				
//				console.log(idx);
//				console.log(player.getCurrentSource());
//				str = defaultSources[player.getCurrentSource()].label;
//				console.log(str);
//				$('#slabel').text(str);
				
				player.play();

			});
			
        });



    </script>
</body>
</html>